<!--Thx to Mary Rose Cook for game skeleton and inspiration-->
<html>
<head>
<link rel='shortcut icon' type='image/x-icon' href='rudydres.ico' />
<style>
body {
  background-image: url("tlo.png");
  background-size: 100% auto;
  background-repeat: no-repeat;
}
#rudydres {
  position: absolute;
  top: 570px;
  overflow: hidden;
  width: 150px;
  height: 150px;
}
#rudydres img {
  margin-left: 0px;
}
#rudydres2 {
  position: absolute;
  top: 570px;
  overflow: hidden;
  width: 150px;
  height: 150px;
}
#rudydres2 img {
  margin-left: 0px;
}
</style>
</head>
<body>
<div id="rudydres">
 <img id="rudydresimage" src="rudydres.png" />
</div>
<div id="rudydres2">
 <img id="rudydres2image" src="rudydres2.png" />
</div>
</body>
</html>
<script type="application/javascript">
;(function() {
 var Game = function() {
  var gameSize = { x: document.body.offsetWidth };
  this.bodies = [];
  this.bodies = this.bodies.concat(new Player(this, gameSize, 37, 39, 'rudydres'));
  this.bodies = this.bodies.concat(new Player(this, gameSize, 65, 68, 'rudydres2'));  

  var self = this;
  var tick = function() {
   self.update();
   self.draw(screen, gameSize);
   requestAnimationFrame(tick);
  };
  tick();
 };

 Game.prototype = {
  update: function() {
   var self = this;
   for (var i = 0; i < this.bodies.length; i++) {
    this.bodies[i].update();
   }
  },
  
  draw: function(screen, gameSize) {
   for (var i = 0; i < this.bodies.length; i++) {
    var rudydres = document.getElementById(this.bodies[i].id);
    var rudydresimage = document.getElementById(this.bodies[i].id + 'image');
    rudydres.style.left = this.bodies[i].center.x + 'px';
    rudydres.style.transform = 'scaleX(' + this.bodies[i].scaleX + ')';
    rudydresimage.style.marginLeft = -((Math.floor(this.bodies[i].anim / 5) % 8) * 150) + 'px';
   }
  }
 };

 var Player = function(game, gameSize, leftKey, rightKey, id) {
  this.id = id;
  this.anim = 0;
  this.game = game;
  this.size = { x: 20, y: 150 };
  this.scaleX = 1;
  this.center = { x: gameSize.x / 2 };
  this.keyboarder = new Keyboarder(leftKey, rightKey);
 };
 Player.prototype = {
  update: function() {
   // If left cursor key is down...
   if (this.keyboarder.isLeftKeyDown()) {
    this.center.x -= 3;
    this.anim++;
    this.scaleX = -1;
   } else if (this.keyboarder.isRightKeyDown()) {
    this.center.x += 3;
    this.anim++;
    this.scaleX = 1;
   }
  }
 };

 var Keyboarder = function(leftKey, rightKey) {
  this.leftKey = leftKey;
  this.rightKey = rightKey;
  var keyState = {};
  window.addEventListener('keydown', function(e) { keyState[e.keyCode] = true; });
  window.addEventListener('keyup', function(e) { keyState[e.keyCode] = false; });
  this.isLeftKeyDown = function() {
   return keyState[this.leftKey] === true;
  };
  this.isRightKeyDown = function() {
   return keyState[this.rightKey] === true;
  };
 };

 window.addEventListener('load', function() { new Game(); });
})();
</script>
